for i in 1:length(path1)
length(path1)
length(year_files)
for (i in 1:length(year_files))
path2<-"./project/volume/data/external/external_data/weekly/",year_files[i]
path2<-"./project/volume/data/external/external_data/weekly/",year_files[i],"
year_week_files<-list.files(path2)
master<-NULL
for (i in 1:length(year_week_files)) {
week <- fread(paste0(path2, "/",year_week_files[i]))
week$week<-i
week$c_week<-1
masteryear_files[i]<-rbind(master,week)
}
}
library(data.table)
path1<-"./project/volume/data/external/external_data/weekly"
year_files<- list.files(path1)
for (i in 1:length(year_files)){
path2<-"./project/volume/data/external/external_data/weekly/",year_files[i],"
year_week_files<-list.files(path2)
master<-NULL
for (i in 1:length(year_week_files)) {
week <- fread(paste0(path2, "/",year_week_files[i]))
week$week<-i
week$c_week<-1
masteryear_files[i]<-rbind(master,week)
}
}
path2<-"./project/volume/data/external/external_data/weekly/",year_files[i],""
library(data.table)
path1<-"./project/volume/data/external/external_data/weekly"
year_files<- list.files(path1)
for (i in 1:length(year_files)){
year <- fread(paste0(path1, "/", year_files))
year
year
year <- fread(paste0(path1, "/", year_files[i]))
path1<-"./project/volume/data/external/external_data/weekly"
year_files<- list.files(path1)
for (i in 1:length(year_files)){
year <- fread(paste0(path1, "/", year_files[i]))
path2<-"./project/volume/data/external/external_data/weekly/",year
year_week_files<-list.files(path2)
master<-NULL
for (i in 1:length(year_week_files)) {
week <- fread(paste0(path2, "/",year_week_files[i]))
week$week<-i
week$c_week<-1
master<-rbind(master,week)
fwrite(master, paste0("./project/volume/data/interim/", master, "_", year, ".csv"))
}
}
path1<-"./project/volume/data/external/external_data/weekly"
year_files<- list.files(path1)
for (i in 1:length(year_files)){
year <- fread(paste0(path1, "/", year_files[i]))
path2<-paste0("./project/volume/data/external/external_data/weekly/",year)
year_week_files<-list.files(path2)
master<-NULL
for (i in 1:length(year_week_files)) {
week <- fread(paste0(path2, "/",year_week_files[i]))
week$week<-i
week$c_week<-1
master<-rbind(master,week)
fwrite(master, paste0("./project/volume/data/interim/", master, "_", year, ".csv"))
}
}
library(data.table)
path1<-"./project/volume/data/external/external_data/weekly"
year_files<- list.files(path1)
for (i in 1:length(year_files)){
year <- fread(paste0(path1, "/", year_files[i]))
path2<-paste0(path1,"/",year)
year_week_files<-list.files(path2)
master<-NULL
for (i in 1:length(year_week_files)) {
week <- fread(paste0(path2, "/",year_week_files[i]))
week$week<-i
week$c_week<-1
master<-rbind(master,week)
fwrite(master, paste0("./project/volume/data/interim/", master, "_", year, ".csv"))
}
}
library(data.table)
path1<-"./project/volume/data/external/external_data/weekly"
year_files<- list.files(path1)
year <- fread(paste0(path1, "/", year_files[i]))
for (i in 1:length(year_files)){
year <- fread(paste0(path1, "/", year_files[i]))
library(data.table)
path1<-"./project/volume/data/external/external_data/weekly"
year_files<- list.files(path1)
for (i in 1:length(year_files)){
year <- fread(paste0(path1, "/", year_files[i]))
path2<-paste0(path1,"/",year)
year_week_files<-list.files(path2)
master<-NULL
for (i in 1:length(year_week_files)) {
week <- fread(paste0(path2, "/",year_week_files[i]))
week$week<-i
week$c_week<-1
master<-rbind(master,week)
fwrite(master, paste0("./project/volume/data/interim/", master, "_", year, ".csv"))
}
}
end
library(data.table)
path<-"./project/volume/data/external/external_data/weekly/2012"
year_week_files<-list.files(path)
master<-NULL
for (i in 1:length(year_week_files)) {
week <- fread(paste0(path, "/",year_week_files[i]))
week$week<-i
week$c_week<-1
master<-rbind(master,week)
}
fwrite(Master2012, "./project/volume/data/interim/2012season.csv")
library(data.table)
path<-"./project/volume/data/external/external_data/weekly/2012"
year_week_files<-list.files(path)
master<-NULL
for (i in 1:length(year_week_files)) {
week <- fread(paste0(path, "/",year_week_files[i]))
week$week<-i
week$c_week<-1
master<-rbind(master,week)
}
fwrite(Master2012, "./project/volume/data/interim/2012season.csv")
library(data.table)
path<-"./project/volume/data/external/external_data/weekly/2012"
year_week_files<-list.files(path)
master<-NULL
for (i in 1:length(year_week_files)) {
week <- fread(paste0(path, "/",year_week_files[i]))
week$week<-i
week$c_week<-1
master<-rbind(master,week)
}
fwrite(master, "./project/volume/data/interim/2012season.csv")
library(data.table)
path1<-"./project/volume/data/external/external_data/weekly"
year_files<- list.files(path1)
library(data.table)
path1<-"./project/volume/data/external/external_data/weekly"
year_files<- list.files(path1)
for (i in 1:length(year_files)){
year <- fread(paste0(path1, "/", year_files[i]))
path2<-paste0(path1,"/",year)
year_week_files<-list.files(path2)
master<-NULL
for (i in 1:length(year_week_files)) {
week <- fread(paste0(path2, "/",year_week_files[i]))
week$week<-i
week$c_week<-1
master<-rbind(master,week)
fwrite(master, paste0("./project/volume/data/interim/", master, "_", year, ".csv"))
}
}
library(data.table)
path1<-"./project/volume/data/external/external_data/weekly"
year_files<- list.files(path1)
for (i in 1:length(year_files)){
year <- fread(paste0(path1, "/", year_files[i]))
path2<-paste0(path1,"/",year)
year_week_files<-list.files(path2)
master<-NULL
for (j in 1:length(year_week_files)) {
week <- fread(paste0(path2, "/",year_week_files[j]))
week$week<-j
week$c_week<-1
master<-rbind(master,week)
}
fwrite(master, paste0("./project/volume/data/interim/", master, "_", year, ".csv"))
}
library(data.table)
path<-"./project/volume/data/external/external_data/weekly/2012"
year_week_files<-list.files(path)
library(data.table)
path1<-"./project/volume/data/external/external_data/weekly"
year_files<- list.files(path1)
library(data.table)
path1<-"./project/volume/data/external/external_data/weekly"
year_files<- list.files(path1)
for (i in 1:length(year_files)){
year <- year_files[i]
path2<-paste0(path1,"/",year)
year_week_files<-list.files(path2)
master<-NULL
for (j in 1:length(year_week_files)) {
week <- fread(paste0(path2, "/",year_week_files[j]))
week$week<-j
week$c_week<-1
master<-rbind(master,week)
}
fwrite(master, paste0("./project/volume/data/interim/", master, "_", year, ".csv"))
}
path1<-"./project/volume/data/external/external_data/weekly"
year_files<- list.files(path1)
for (i in 1:length(year_files)){
year <- year_files[i]
path2<-paste0(path1,"/",year)
year_week_files<-list.files(path2)
master<-NULL
for (j in 1:length(year_week_files)) {
week <- fread(paste0(path2, "/",year_week_files[j]))
week$week<-j
week$c_week<-1
master<-rbind(master,week)
}
fwrite(master, paste0("./project/volume/data/interim/", master, "_", year, ".csv"))
}
library(data.table)
path1<-"./project/volume/data/external/external_data/weekly"
year_files<- list.files(path1)
for (i in 1:length(year_files)){
year <- year_files[i]
path2<-paste0(path1,"/",year)
year_week_files<-list.files(path2)
master<-NULL
for (j in 1:length(year_week_files)) {
week <- fread(paste0(path2, "/",year_week_files[j]))
week$week<-j
week$c_week<-1
master<-rbind(master,week)
}
fwrite(master, paste0("./project/volume/data/interim/", year, ".csv"))
}
library(data.table)
path1<-"./project/volume/data/external/external_data/weekly"
year_files<- list.files(path1)
for (i in 1:length(year_files)){
year <- year_files[i]
path2<-paste0(path1,"/",year)
year_week_files<-list.files(path2)
master<-NULL
for (j in 1:length(year_week_files)) {
week <- fread(paste0(path2, "/",year_week_files[j]))
week$week<-j
week$c_week<-1
master<-rbind(master,week)
}
fwrite(master, paste0("./project/volume/data/interim/", year,"season", ".csv"))
}
library(data.table)
path1<-"./project/volume/data/external/external_data/weekly"
year_files<- list.files(path1)
for (i in 1:length(year_files)){
year <- year_files[i]
path2<-paste0(path1,"/",year)
year_week_files<-list.files(path2)
master<-NULL
for (j in 1:length(year_week_files)) {
week <- fread(paste0(path2, "/",year_week_files[j]))
week$week<-j
week$c_week<-1
master<-rbind(master,week)
}
fwrite(master, paste0("./project/volume/data/interim/", year,"_", "season", ".csv"))
}
library(data.table)
path<-"./project/volume/data/external/SeasonBoxSores"
year_files<-list.files(path)
library(data.table)
path1<-"./project/volume/data/external/external_data/weekly"
year_files<- list.files(path1)
library(data.table)
path<-"./project/volume/data/external/SeasonBoxSores"
year_files<-list.files(path)
year_files
library(data.table)
Season2009-<fread("./project/volume/data/interim/2009_season.csv")
Season2009<-fread("./project/volume/data/interim/2009_season.csv")
Season2009
season2009<-fread("./project/volume/data/interim/2009_season.csv")
season2009<-fread("./project/volume/data/interim/2009_season.csv")
boxScore2009<-fread("./project/volume/data/external/SeasonBoxScores/2009boxscores.csv")
(1&&1)
(1||2)
View(boxScore2009)
View(season2009)
season2009<-cbind(season2009,boxScore2009)
View(season2009)
library(data.table)
season2009<-fread("./project/volume/data/interim/2009_season.csv")
boxScore2009<-fread("./project/volume/data/external/SeasonBoxScores/2009boxscores.csv")
season2009<-cbind(season2009,boxScore2009)
library(data.table)
season2009<-fread("./project/volume/data/interim/2009_season.csv")
boxScore2009<-fread("./project/volume/data/external/SeasonBoxScores/2009boxscores.csv")
View(season2009)
View(boxScore2009)
season2009$game_id <-boxScore2009$game_id
boxScore2009<-[,.(game_id,home_team,away_team,week,season,home_score,away_score)]
boxScore2009<-boxScore2009[,.(game_id,home_team,away_team,week,season,home_score,away_score)]
path<-"./project/volume/data/external/SeasonBoxScores/"
list.files(path)
library(data.table)
path<-"./project/volume/data/external/SeasonBoxScores/"
year_files<-list.files(path)
library(data.table)
path<-"./project/volume/data/external/SeasonBoxScores/"
year_files<-list.files(path)
for (i in 1:length(year_files)) {
year_files[i] <- year_files[i][,.(game_id,home_team,away_team,week,season,home_score,away_score)]
}
library(data.table)
path<-"./project/volume/data/external/SeasonBoxScores/"
year_files<-list.files(path)
for (i in 1:length(year_files)) {
data_table<-fread(paste0(path,"/",year_files[i]))
data_table<-data_table[,.(game_id,home_team,away_team,week,season,home_score,away_score)]
}
library(data.table)
path<-"./project/volume/data/external/SeasonBoxScores/"
year_files<-list.files(path)
library(data.table)
path<-"./project/volume/data/external/SeasonBoxScores/"
year_files<-list.files(path)
for (i in 1:length(year_files)) {
data_table<-fread(paste0(path,"/",year_files[i]))
data_table<-data_table[,.(game_id,home_team,away_team,week,season,home_score,away_score)]
year<-data_table$season
fwrite(data_table, paste0("./project/volume/data/interim/", year,"_", "seasonboxscores", ".csv"))
}
library(data.table)
path<-"./project/volume/data/external/SeasonBoxScores/"
year_files<-list.files(path)
for (i in 1:length(year_files)) {
year <-year_files[i]
data_table<-fread(paste0(path,"/",year_files[i]))
data_table<-data_table[,.(game_id,home_team,away_team,week,season,home_score,away_score)]
fwrite(data_table, paste0("./project/volume/data/interim/", year,"_", "seasonboxscores", ".csv"))
}
library(data.table)
path<-"./project/volume/data/external/SeasonBoxScores/"
year_files<-list.files(path)
for (i in 1:length(year_files)) {
year <-year_files[i]
data_table<-fread(paste0(path,"/",year_files[i]))
data_table<-data_table[,.(game_id,home_team,away_team,week,season,home_score,away_score)]
fwrite(data_table, paste0("./project/volume/data/interim/", "season",year, ".csv"))
}
library(data.table)
path<-"./project/volume/data/external/SeasonBoxScores/"
year_files<-list.files(path)
for (i in 1:length(year_files)) {
data_table<-fread(paste0(path,"/",year_files[i]))
data_table<-data_table[,.(game_id,home_team,away_team,week,season,home_score,away_score)]
year <- data_table$season
fwrite(data_table, paste0("./project/volume/data/interim/", "seasonboxscores",year, ".csv"))
}
library(data.table)
path<-"./project/volume/data/external/SeasonBoxScores/"
year_files<-list.files(path)
for (i in 1:length(year_files)) {
year <- year_files[i]
data_table<-fread(paste0(path,"/",year_files[i]))
data_table<-data_table[,.(game_id,home_team,away_team,week,season,home_score,away_score)]
fwrite(data_table, paste0("./project/volume/data/interim/", "season",year, ".csv"))
}
library(data.table)
library(data.table)
path<-"./project/volume/data/external/SeasonBoxScores/"
year_files<-list.files(path)
for (i in 1:length(year_files)) {
year <- year_files[i]
data_table<-fread(paste0(path,"/",year_files[i]))
data_table<-data_table[,.(game_id,home_team,away_team,week,season,home_score,away_score)]
fwrite(data_table, paste0("./project/volume/data/interim/", "season",year))
}
boxScores09<-fread("./project/volume/data/interim/season2009boxscores.csv")
View(boxScores09)
seasonData09<-fread("./project/volume/data/interim/2009_season.csv")
master<-merge(seasonData09,boxScores09,
by = seasonData09$week == boxScores09$week && (seasonData09$Tm == boxScores09$home_team ||
seasonData09$Tm == boxScores09$away_team))
master<-merge(seasonData09,boxScores09)
library(data.table)
stats2009<-fread("./project/volume/data/interim/2009_season/csv")
stats2009<-fread("./project/volume/data/interim/2009_season.csv")
stats2009
view(boxscores2009)
boxscores2009<-fread("./project/volume/data/interim/season2009boxscores.csv")
View(stats2009)
View(boxscores2009)
boxscores2009
home<-boxscores2009[,.(game_id,home_team,week,season,home_score)]
stats2009
library(data.table)
path1<-"./project/volume/data/external/external_data/weekly"
year_files<- list.files(path1)
if (file.exists("./project/volume/data/interim/gamePlayerstats.csv")) {file.remove("./project/volume/data/interim/gamePlayerstats.csv")}
for (i in 1:length(year_files)){
year <- year_files[i]
path2<-paste0(path1,"/",year)
year_week_files<-list.files(path2)
master<-NULL
for (j in 1:length(year_week_files)) {
week <- fread(paste0(path2, "/",year_week_files[j]))
week$week<-j
week$c_week<-1
week$season<-year
master<-rbind(master,week)
}
fwrite(master,"./project/volume/data/interim/gamePlayerstats.csv",append = T)
}
playerstats<-fread("./project/volume/data/interim/gamePlayerstats.csv")
home<-boxscores2009[,.(game_id,home_team,week,season,home_score)]
setnames(home,c("home_team","home_score"),c("team","score"))
away<-boxscores2009[,.(game_id,away_team,week,season,away_score)]
setnames(home,c("away_team","away_score"),c("team","score"))
boxscores2009<-fread("./project/volume/data/interim/season2009boxscores.csv")
home<-boxscores2009[,.(game_id,home_team,week,season,home_score)]
setnames(home,c("home_team","home_score"),c("team","score"))
away<-boxscores2009[,.(game_id,away_team,week,season,away_score)]
setnames(home,c("away_team","away_score"),c("team","score"))
home<-boxscores2009[,.(game_id,home_team,week,season,home_score)]
setnames(home,c("home_team","home_score"),c("team","score"))
away<-boxscores2009[,.(game_id,away_team,week,season,away_score)]
setnames(away,c("away_team","away_score"),c("team","score"))
allboxscores<-rbind(home,away)
allboxscores
home<-boxscores2009[,.(game_id,home_team,week,season,home_score)]
setnames(home,c("home_team","home_score"),c("Tm","score"))
away<-boxscores2009[,.(game_id,away_team,week,season,away_score)]
setnames(away,c("away_team","away_score"),c("Tm","score"))
allboxscores<-rbind(home,away)
allboxscores
merge(allboxscores,allboxscores,by=c("game_id","week","season"),allow.cartesian = T)
allboxscores<-merge(allboxscores,allboxscores,by=c("game_id","week","season"),allow.cartesian = T)
setnames(allboxscores,c("Tm.x","score.x","Tm.y","score.y"), c("Tm","Tmscore","Opponent","Opponentscore"))
allboxscores<-allboxscores[!Tm==Opponent]
allboxscores
setkey(playerstats,week,season,Tm)
setkey(allboxscores,week,season,Tm)
scoresandstats<-merge(playerstats,allboxscores, all.x = T)
View(scoresandstats)
scoresandstats[season==2009]
library(data.table)
path<-"./project/volume/data/external/SeasonBoxScores/"
year_files<-list.files(path)
if (file.exists("./project/volume/data/interim/allBoxscores.csv")) {
file.remove("./project/volume/data/interim/allBoxscores.csv")}
for (i in 1:length(year_files)) {
year <- year_files[i]
data_table<-fread(paste0(path,"/",year_files[i]))
data_table<-data_table[,.(game_id,home_team,away_team,week,season,home_score,away_score)]
fwrite(data_table,"./project/volume/data/interim/allBoxscores.csv", append=T)
}
library(data.table)
playerstats<-fread("./project/volume/data/interim/gamePlayerstats.csv")
boxscores<-fread("./project/volume/data/interim/allBoxscores.csv")
home<-boxscores[,.(game_id,home_team,week,season,home_score)]
setnames(home,c("home_team","home_score"),c("Tm","score"))
away<-boxscores[,.(game_id,away_team,week,season,away_score)]
setnames(away,c("away_team","away_score"),c("Tm","score"))
allboxscores<-rbind(home,away)
allboxscores<-merge(allboxscores,allboxscores,by=c("game_id","week","season"),allow.cartesian = T)
setnames(allboxscores,c("Tm.x","score.x","Tm.y","score.y"), c("Tm","Tmscore","Opponent","Opponentscore"))
allboxscores<-allboxscores[!Tm==Opponent]
setkey(playerstats,week,season,Tm)
setkey(allboxscores,week,season,Tm)
scoresandstats<-merge(playerstats,allboxscores, all.x = T)
View(scoresandstats)
scoresandstats[year>2008]
str(scoresandstats)
scoresandstats[season>2008]
fwrite(scoresandstats,"project/volume/data/interim/StatsandBoxscores.csv")
fwrite(scoresandstats,"project/volume/data/processed/StatsandBoxscores.csv")
fwrite(scoresandstats[season>2008],"project/volume/data/processed/StatsandBoxscores.csv")
library(data.table)
statsandscores<-fread("./project/volume/data/processed/StatsandBoxscores.csv")
statsandscores
teamAllowed<-dcast(statsandscores,Opponent~.,sum,na.rm=T,value.var = c("PassingYds","Int","PassingAtt"))
teamAllowed
teamAllowed<-dcast(statsandscores,Opponent+game_id+Season+week~.,sum,na.rm=T,value.var = c("PassingYds","Int","PassingAtt"))
teamAllowed<-dcast(statsandscores,Opponent+game_id+season+week~.,sum,na.rm=T,value.var = c("PassingYds","Int","PassingAtt"))
teamAllowed
teamAllowed<-dcast(statsandscores,Opponent+game_id+season+week+c_week~.,sum,na.rm=T,value.var = c("PassingYds","Int","PassingAtt"))
teamAllowed
scoresandstats
scoresandstats<-scoresandstats[order(season,week)]
scoresandstats[,.(cumulativeweek:=cumsum(c_week)),by="Tm"]
scoresandstats[,.(cumulativeweek=cumsum(c_week)),by="Tm"]
scoresandstats[,.(cumulativeweek := cumsum(c_week)),by="Tm"]
scoresandstats[,cumulativeweek := cumsum(c_week),by="Tm"]
scoresandstats
scoresandstats[Tm="DAL"]
scoresandstats[Tm=="DAL"]
fwrite(scoresandstats[season>2008],"project/volume/data/processed/StatsandBoxscores.csv")
library(data.table)
statsandscores<-fread("./project/volume/data/processed/StatsandBoxscores.csv")
teamAllowed<-dcast(statsandscores,Opponent+game_id+season+week+c_week~.,sum,na.rm=T,value.var = c("PassingYds","Int","PassingAtt"))
teamAllowed<-dcast(statsandscores,Opponent+game_id+season+week+cumulativeweek~.,sum,na.rm=T,value.var = c("PassingYds","Int","PassingAtt"))
teamAllowed
setkey(teamAllowed,Opponent,cumulativeweek)
teamAllowed[, roll_3_passing_yards := Reduce(`+`, shift(PassingYds, 0:2))]
teamAllowed
teamAllowed[Opponent == "WAS"]
statsandscores<-fread("./project/volume/data/processed/StatsandBoxscores.csv")
teamAllowed<-dcast(statsandscores,Opponent+game_id+season+week+cumulativeweek~.,sum,na.rm=T,value.var = c("PassingYds","Int","PassingAtt"))
teamAllowed[Opponent=="WAS"]
teamAllowed<-statsandscores[,.(PassingYds=sum(PassingYds)),by=c("Opponent","game_id","season,
week", "cumulativeweek")]
teamAllowed<-statsandscores[,.(PassingYds=sum(PassingYds)),by=c("Opponent","game_id","season",
"week", "cumulativeweek")]
teamAllowed
library(data.table)
data<-fread("./project/volume/data/raw/NFLCombine2017.csv")
data<-fread("./project/volume/data/raw/NFLCombine2017.sav")
data<-fread("./project/volume/data/raw/NFLCombine2017.sav")
